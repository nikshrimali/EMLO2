[2022-10-04 02:40:33,657][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-10-04 02:40:33,665][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-10-04 02:40:33,665][src.utils.rich_utils][WARNING] - Testing inside rich utils'['datamodule', 'model', 'callbacks', 'logger', 'trainer', 'paths', 'extras', 'task_name', 'tags', 'train', 'test', 'ckpt_path', 'seed']'...
[2022-10-04 02:40:33,742][__main__][INFO] - Instantiating datamodule <src.datamodules.cifar_datamodule.CIFARDataModule>
[2022-10-04 02:40:33,748][__main__][INFO] - Instantiating model <src.models.cifar_module.CIFARLitModule>
[2022-10-04 02:40:34,056][timm.models.helpers][INFO] - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
[2022-10-04 02:40:35,019][__main__][INFO] - Instantiating callbacks...
[2022-10-04 02:40:35,019][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-10-04 02:40:35,101][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-10-04 02:40:35,104][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-10-04 02:40:35,105][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-10-04 02:40:35,106][__main__][INFO] - Instantiating loggers...
[2022-10-04 02:40:35,107][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2022-10-04 02:40:35,111][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-10-04 02:40:35,144][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.8/site-packages/pytorch_lightning/utilities/argparse.py", line 345, in insert_env_defaults
    return fn(self, **kwargs)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 433, in __init__
    self._accelerator_connector = AcceleratorConnector(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py", line 210, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "/workspace/.pyenv_mirror/user/current/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py", line 516, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
pytorch_lightning.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/EMLO/Assignment04/lightning-hydra-template/src/utils/utils.py", line 39, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "./lightning-hydra-template/src/train.py", line 79, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 222, in instantiate
    return instantiate_node(
  File "/workspace/.pyenv_mirror/user/current/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 339, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pytorch_lightning.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2022-10-04 02:40:35,149][src.utils.utils][INFO] - Closing loggers...
[2022-10-04 02:41:17,005][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-10-04 02:41:17,013][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-10-04 02:41:17,014][src.utils.rich_utils][WARNING] - Testing inside rich utils'['datamodule', 'model', 'callbacks', 'logger', 'trainer', 'paths', 'extras', 'task_name', 'tags', 'train', 'test', 'ckpt_path', 'seed']'...
[2022-10-04 02:41:17,092][__main__][INFO] - Instantiating datamodule <src.datamodules.cifar_datamodule.CIFARDataModule>
[2022-10-04 02:41:17,097][__main__][INFO] - Instantiating model <src.models.cifar_module.CIFARLitModule>
[2022-10-04 02:41:17,423][timm.models.helpers][INFO] - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
[2022-10-04 02:41:17,521][__main__][INFO] - Instantiating callbacks...
[2022-10-04 02:41:17,522][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-10-04 02:41:17,526][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-10-04 02:41:17,600][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-10-04 02:41:17,601][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-10-04 02:41:17,602][__main__][INFO] - Instantiating loggers...
[2022-10-04 02:41:17,602][src.utils.utils][INFO] - Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2022-10-04 02:41:17,606][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-10-04 02:41:17,660][__main__][INFO] - Logging hyperparameters!
[2022-10-04 02:41:17,677][__main__][INFO] - Starting training!
[2022-10-04 03:42:14,528][__main__][INFO] - Scripting Model....
[2022-10-04 03:42:15,301][__main__][INFO] - Saving Model.... to {cfg.paths.output_dir}/model.script.pt
[2022-10-04 03:42:15,301][__main__][INFO] - Starting testing!
[2022-10-04 03:42:23,647][__main__][INFO] - Best ckpt path: /workspace/EMLO/Assignment04/lightning-hydra-template/logs/train/runs/2022-10-04_02-41-16/checkpoints/epoch_007.ckpt
[2022-10-04 03:42:23,649][src.utils.utils][INFO] - Closing loggers...
[2022-10-04 03:42:23,651][src.utils.utils][INFO] - Output dir: /workspace/EMLO/Assignment04/lightning-hydra-template/logs/train/runs/2022-10-04_02-41-16
[2022-10-04 03:42:23,652][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
